var Recipe=require("../models/recipes"),Ingredient=require("../models/ingredients"),_=require("lodash");exports.index=function(e,n){Recipe.find({}).populate("ingredients").exec(function(e,i){e?n.status(500).json(e):n.status(201).json(i)})},exports.create=function(e,n){var i,s=e.body.recipe,t=e.body.ingredients,o=new Recipe(s);_.forEach(t,function(e,s){e._recipe=o._id,i=new Ingredient(e),o.ingredients.push(i._id),i.save(function(e){e&&(console.log(e),n.status(500).json(e))})}),o.save(function(e,i){e?n.status(500).json(e):(s.ingredients=t,s._id=i._id,n.status(201).json(s))})},exports.destroy=function(e,n){var i=e.params.id;Recipe.findOneAndRemove({_id:i},function(e,i){e?n.status(500).json(e):n.status(200).json(i)})};