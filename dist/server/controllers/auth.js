var User=require("../models/users"),jwt=require("jwt-simple"),_=require("lodash"),config=require("../config"),today=new Date,exp=new Date(today);exp.setDate(today.getDate()+60),exports.login=function(e,s){var t=e.body;User.findOne({email:t.email},function(n,o){if(n)s.status(500).json(n);else if(o||s.status(500).json({msg:"Incorrect username."}),t.password===o.password){var i=jwt.encode({email:o.email,uuid:o._id,exp:parseInt(exp.getTime()/1e3)},config.secret);e.session.user=o._id,s.status(200).json(i)}else s.status(500).json({msg:"Incorrect password."})})},exports.signup=function(e,s){var t=new User(e.body);t.save(function(t,n){if(t)s.status(500).json(t);else{var o=jwt.encode({email:n.email,uuid:n._id,exp:parseInt(exp.getTime()/1e3)},config.secret);e.session.user=n._id,s.status(200).json(o)}})},exports.logout=function(e,s){e.session.user=null,s.status(200).json({response:!0})};