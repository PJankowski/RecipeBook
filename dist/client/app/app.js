!function(){"use strict";angular.module("Recipes",["ui.router","firebase","Postman"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,n,t){n.otherwise("/"),t.html5Mode(!0),e.state("recipes",{url:"/recipes",templateUrl:"/app/partials/recipes.html",controller:"RecipesCtrl",onEnter:["$state","$rootScope","Auth",function(e,n,t){return t.isLoggedIn()?(n.state="recipes",!0):(n.state="",void e.go("home"))}]}).state("menu",{url:"/menu",templateUrl:"/app/partials/menu.html",controller:"MenuCtrl",onEnter:["$state","$rootScope","Auth",function(e,n,t){return t.isLoggedIn()?(n.state="menu",!0):(n.state="",void e.go("home"))}]}).state("shopping",{url:"/shopping",templateUrl:"/app/partials/shopping.html",controller:"ShoppingCtrl",onEnter:["$state","$rootScope","Auth",function(e,n,t){return t.isLoggedIn()?(n.state="shopping",!0):(n.state="",void e.go("home"))}]}).state("home",{url:"/",templateUrl:"/app/partials/home.html",controller:"AuthCtrl",onEnter:["$state","$rootScope","Auth",function(e,n,t){return t.isLoggedIn()?(n.state="recipes",void e.go("recipes")):!0}]})}]).run(["$rootScope","$state","$timeout","Auth",function(e,n,t,r){e.logout=function(){r.logUserOut().then(function(){e.user=null,n.go("home")})}}]).constant("FIREBASE_URL","https://bookofrecipesstaging.firebaseio.com/")}(),function(){"use strict";angular.module("Recipes").factory("Auth",["$firebaseAuth","$q","FIREBASE_URL",function(e,n,t){var r,o=new Firebase(t);return r=e(o),{signIn:function(e){var t=n.defer();return r.$authWithPassword(e).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise},signUp:function(e){return r.$createUser(e)},isLoggedIn:function(){return r.$getAuth()?!0:!1},getSignedInUser:function(){return r.$getAuth()},logUserOut:function(){var e=n.defer();return r.$unauth(),e.resolve(!0),e.promise}}}])}(),function(){"use strict";angular.module("Recipes").factory("User",["$firebaseArray","$firebaseObject","$q","FIREBASE_URL",function(e,n,t,r){var o,i=new Firebase(r+"/users");return o=e(i),{createUser:function(e){return o.$add(e)},getProfile:function(e){return n(i.child(e))},getDisplayName:function(e){return o.$getRecord(e).displayName},all:function(){return o}}}])}(),function(){"use strict";angular.module("Recipes").factory("Recipe",["$firebaseArray","$q","$rootScope","FIREBASE_URL",function(e,n,t,r){var o=new Firebase(r+"/recipes"),i=e(o);return{getRecipes:function(){return i},addNewRecipe:function(e){i.$add(e)},updateInMenu:function(e,t){i[e].inMenu=!0,i[e].menuId=t;var r=n.defer();return i.$save(e).then(function(){r.resolve(!0)}),r.promise},removeMenu:function(e){i[e].inMenu=!1,i.$save(e)},removeRecipe:function(e){i.$remove(e)}}}])}(),function(){"use strict";angular.module("Recipes").factory("Menu",["$firebaseArray","$q","FIREBASE_URL",function(e,n,t){var r=new Firebase(t+"/menu"),o=e(r);return{getMenu:function(){return o},addToMenu:function(e){console.log(e),angular.forEach(e.ingredients,function(e,n){e.bought=!1});var t=n.defer();return o.$add(e).then(function(e){t.resolve(e.key())}),t.promise},removeItem:function(e){var t=o.$getRecord(e.menuId),r=n.defer();return o.$remove(t).then(function(){r.resolve(!0)}),r.promise},buyIngredient:function(e,n,t){o[n].ingredients[t]=e,o.$save(o[n])}}}])}(),function(){"use strict";angular.module("Recipes").factory("Shopping",["$firebaseArray","$q","FIREBASE_URL",function(e,n,t){var r=new Firebase(t+"/shoppingList"),o=e(r);return{getItems:function(){return o},addToList:function(e){angular.forEach(e,function(e,n){o.$add(e)})}}}])}(),function(){"use strict";angular.module("Recipes").controller("AuthCtrl",["$scope","$rootScope","$state","Auth","User",function(e,n,t,r,o){e.title="Welcome",e.login=function(e){r.signIn(e).then(function(e){n.user=e,console.log(e),t.go("recipes")})},e.signup=function(e){r.signUp(e).then(function(i){o.createUser(i).then(function(){r.signIn(e).then(function(e){n.user=e,t.go("recipes")})})})}}])}(),function(){"use strict";angular.module("Recipes").controller("RecipesCtrl",["$scope","Recipe","Menu","Shopping",function(e,n,t,r){e.title="Recipes",e.newForm=!1,e.recipes=n.getRecipes(),e.ingredients=[1],e.newRecipe=function(){e.newForm=!e.newForm},e.addIngredient=function(){var n=e.ingredients.length+1;e.ingredients.push(n)},e.addRecipe=function(t){n.addNewRecipe(t),e.newRec="",e.newForm=!1},e.removeRecipe=function(e){n.removeRecipe(e)},e.removeIngredient=function(n){e.ingredients.splice(n,1)},e.addToMenu=function(e,r){e.inMenu=!0,t.addToMenu(e).then(function(e){n.updateInMenu(r,e)})},e.removeMenu=function(e,r){t.removeItem(e).then(function(){n.removeMenu(r)})}}])}(),function(){"use strict";angular.module("Recipes").controller("MenuCtrl",["$scope","Menu",function(e,n){e.title="Menu",e.menu=n.getMenu()}])}(),function(){"use strict";angular.module("Recipes").controller("ShoppingCtrl",["$scope","Shopping","Menu",function(e,n,t){e.title="Shopping List",e.list=t.getMenu(),e.buyItem=function(e,n,r){e.bought=!e.bought,t.buyIngredient(e,n,r)}}])}();