!function(){"use strict";angular.module("Recipes",["ui.router","firebase"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,n,t){n.otherwise("/home"),t.html5Mode(!0),e.state("recipes",{url:"/",templateUrl:"/app/partials/recipes.html",controller:"RecipesCtrl",onEnter:["$state","$rootScope","Auth",function(e,n,t){return t.isLoggedIn()?!0:(n.state="",void e.go("home"))}]}).state("menu",{url:"/menu",templateUrl:"/app/partials/menu.html",controller:"MenuCtrl",onEnter:["$state","$rootScope","Auth",function(e,n,t){return t.isLoggedIn()?!0:(n.state="",void e.go("home"))}]}).state("shopping",{url:"/shopping",templateUrl:"/app/partials/shopping.html",controller:"ShoppingCtrl",onEnter:["$state","$rootScope","Auth",function(e,n,t){return t.isLoggedIn()?!0:(n.state="",void e.go("home"))}]}).state("home",{url:"/home",templateUrl:"/app/partials/home.html",controller:"AuthCtrl",onEnter:["$state","Auth",function(e,n){return n.isLoggedIn()?void e.go("recipes"):!0}]})}]).run(["$rootScope","$state","$timeout","Auth",function(e,n,t,o){return o.isLoggedIn()?!0:(n.go("home"),e.logout=function(){o.logUserOut()},void e.$on("$stateChangeSuccess",function(n,t,o,r,i){e.state=t.name}))}]).constant("FIREBASE_URL","https://bookofrecipesstaging.firebaseio.com/")}(),function(){"use strict";angular.module("Recipes").factory("Auth",["$firebaseAuth","$q","FIREBASE_URL",function(e,n,t){var o,r=new Firebase(t);return o=e(r),{signIn:function(e){var t=n.defer();return o.$authWithPassword(e).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise},signUp:function(e){return o.$createUser(e)},isLoggedIn:function(){return o.$getAuth()?!0:!1},getSignedInUser:function(){return o.$getAuth()},logUserOut:function(){o.$unauth()}}}])}(),function(){"use strict";angular.module("Recipes").factory("Recipe",["$firebaseArray","$q","FIREBASE_URL",function(e,n,t){var o=new Firebase(t+"/recipes"),r=e(o);return{getRecipes:function(){return r},addNewRecipe:function(e){r.$add(e)},updateInMenu:function(e,t){r[e].inMenu=!0,r[e].menuId=t;var o=n.defer();return r.$save(e).then(function(){o.resolve(!0)}),o.promise},removeMenu:function(e){r[e].inMenu=!1,r.$save(e)},removeRecipe:function(e){r.$remove(e)}}}])}(),function(){"use strict";angular.module("Recipes").factory("Menu",["$firebaseArray","$q","FIREBASE_URL",function(e,n,t){var o=new Firebase(t+"/menu"),r=e(o);return{getMenu:function(){return r},addToMenu:function(e){console.log(e),angular.forEach(e.ingredients,function(e,n){e.bought=!1});var t=n.defer();return r.$add(e).then(function(e){t.resolve(e.key())}),t.promise},removeItem:function(e){var t=r.$getRecord(e.menuId),o=n.defer();return r.$remove(t).then(function(){o.resolve(!0)}),o.promise},buyIngredient:function(e,n,t){r[n].ingredients[t]=e,r.$save(r[n])}}}])}(),function(){"use strict";angular.module("Recipes").factory("Shopping",["$firebaseArray","$q","FIREBASE_URL",function(e,n,t){var o=new Firebase(t+"/shoppingList"),r=e(o);return{getItems:function(){return r},addToList:function(e){angular.forEach(e,function(e,n){r.$add(e)})}}}])}(),function(){"use strict";angular.module("Recipes").controller("AuthCtrl",["$scope","$rootScope","$state","Auth",function(e,n,t,o){e.title="Welcome",e.login=function(e){o.signIn(e).then(function(e){n.user=e,t.go("recipes")})},e.signup=function(e){o.signUp(e).then(function(){o.signIn(e).then(function(e){n.user=e,t.go("recipes")})})}}])}(),function(){"use strict";angular.module("Recipes").controller("RecipesCtrl",["$scope","Recipe","Menu","Shopping",function(e,n,t,o){e.title="Recipes",e.newForm=!1,e.recipes=n.getRecipes(),e.ingredients=[1],e.newRecipe=function(){e.newForm=!e.newForm},e.addIngredient=function(){var n=e.ingredients.length+1;e.ingredients.push(n)},e.addRecipe=function(t){n.addNewRecipe(t),e.newRec="",e.newForm=!1},e.removeRecipe=function(e){n.removeRecipe(e)},e.removeIngredient=function(n){e.ingredients.splice(n,1)},e.addToMenu=function(e,o){e.inMenu=!0,t.addToMenu(e).then(function(e){n.updateInMenu(o,e)})},e.removeMenu=function(e,o){t.removeItem(e).then(function(){n.removeMenu(o)})}}])}(),function(){"use strict";angular.module("Recipes").controller("MenuCtrl",["$scope","Menu",function(e,n){e.title="Menu",e.menu=n.getMenu()}])}(),function(){"use strict";angular.module("Recipes").controller("ShoppingCtrl",["$scope","Shopping","Menu",function(e,n,t){e.title="Shopping List",e.list=t.getMenu(),e.buyItem=function(e,n,o){e.bought=!e.bought,t.buyIngredient(e,n,o)}}])}();