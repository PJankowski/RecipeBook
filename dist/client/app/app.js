!function(){"use strict";angular.module("Recipes",["ui.router","firebase"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,n,t){n.otherwise("/home"),t.html5Mode(!0),e.state("recipes",{url:"/",templateUrl:"/app/partials/recipes.html",controller:"RecipesCtrl",onEnter:["$state","Auth",function(e,n){return n.isLoggedIn()?!0:void e.go("home")}]}).state("menu",{url:"/menu",templateUrl:"/app/partials/menu.html",controller:"MenuCtrl",onEnter:["$state","Auth",function(e,n){return n.isLoggedIn()?!0:void e.go("home")}]}).state("shopping",{url:"/shopping",templateUrl:"/app/partials/shopping.html",controller:"ShoppingCtrl",onEnter:["$state","Auth",function(e,n){return n.isLoggedIn()?!0:void e.go("home")}]}).state("home",{url:"/home",templateUrl:"/app/partials/home.html",controller:"HomeCtrl",onEnter:["$state","Auth",function(e,n){return n.isLoggedIn()?void e.go("recipes"):!0}]})}]).run(["$rootScope","$state","Auth",function(e,n,t){return t.isLoggedIn()?!0:(n.go("home"),e.logout=function(){t.logUserOut()},void e.$on("$stateChangeSuccess",function(n,t,o,r,i){e.state=t.name}))}])}(),function(){"use strict";angular.module("Recipes").factory("Auth",["$firebaseAuth","$q",function(e,n){var t,o=new Firebase("https://bookofrecipes.firebaseio.com");return t=e(o),{signIn:function(e){var o=n.defer();return t.$authWithPassword(e).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},isLoggedIn:function(){return t.$getAuth()?!0:!1},getSignedInUser:function(){return t.$getAuth()},logUserOut:function(){t.$unauth()}}}])}(),function(){"use strict";angular.module("Recipes").factory("Recipe",["$firebaseArray","$q",function(e,n){var t=new Firebase("https://bookofrecipes.firebaseio.com/recipes"),o=e(t);return{getRecipes:function(){return o},addNewRecipe:function(e){o.$add(e)},updateInMenu:function(e,t){o[e].inMenu=!0,o[e].menuId=t;var r=n.defer();return o.$save(e).then(function(){r.resolve(!0)}),r.promise},removeMenu:function(e){o[e].inMenu=!1,o.$save(e)},removeRecipe:function(e){o.$remove(e)}}}])}(),function(){"use strict";angular.module("Recipes").factory("Menu",["$firebaseArray","$q",function(e,n){var t=new Firebase("https://bookofrecipes.firebaseio.com/menu"),o=e(t);return{getMenu:function(){return o},addToMenu:function(e){console.log(e),angular.forEach(e.ingredients,function(e,n){e.bought=!1});var t=n.defer();return o.$add(e).then(function(e){t.resolve(e.key())}),t.promise},removeItem:function(e){var t=o.$getRecord(e.menuId),r=n.defer();return o.$remove(t).then(function(){r.resolve(!0)}),r.promise},buyIngredient:function(e,n,t){o[n].ingredients[t]=e,o.$save(o[n])}}}])}(),function(){"use strict";angular.module("Recipes").factory("Shopping",["$firebaseArray","$q",function(e,n){var t=new Firebase("https://bookofrecipes.firebaseio.com/shoppingList"),o=e(t);return{getItems:function(){return o},addToList:function(e){angular.forEach(e,function(e,n){o.$add(e)})}}}])}(),function(){"use strict";angular.module("Recipes").controller("HomeCtrl",["$scope",function(e){e.title="Home"}])}(),function(){"use strict";angular.module("Recipes").controller("RecipesCtrl",["$scope","Recipe","Menu","Shopping",function(e,n,t,o){e.title="Recipes",e.newForm=!1,e.recipes=n.getRecipes(),e.ingredients=[1],e.newRecipe=function(){e.newForm=!e.newForm},e.addIngredient=function(){var n=e.ingredients.length+1;e.ingredients.push(n)},e.addRecipe=function(t){n.addNewRecipe(t),e.newRec="",e.newForm=!1},e.removeRecipe=function(e){n.removeRecipe(e)},e.removeIngredient=function(n){e.ingredients.splice(n,1)},e.addToMenu=function(e,o){e.inMenu=!0,t.addToMenu(e).then(function(e){n.updateInMenu(o,e)})},e.removeMenu=function(e,o){t.removeItem(e).then(function(){n.removeMenu(o)})}}])}(),function(){"use strict";angular.module("Recipes").controller("MenuCtrl",["$scope","Menu",function(e,n){e.title="Menu",e.menu=n.getMenu()}])}(),function(){"use strict";angular.module("Recipes").controller("ShoppingCtrl",["$scope","Shopping","Menu",function(e,n,t){e.title="Shopping List",e.list=t.getMenu(),e.buyItem=function(e,n,o){e.bought=!e.bought,t.buyIngredient(e,n,o)}}])}();